{% extends "research/base.html" %}
{% load i18n %}

{% block heading %}{{ object.name }}{% endblock %}

{% block action %}
    {% if perms.research.delete_work %}
    <form novalidate class='form-inline' action='{% url "work:delete" work.pk %}' method='POST'>
        {% csrf_token %}
        <div class='form-group'>
            <button type='submit' class='btn btn-link text-danger confirm-delete p-0 ml-2'
                data-what='work'>{% trans 'Delete' %}</button>
        </div>
    </form>    
    {% endif %} 
{% endblock %}

{% block inner %}
    <hr>
    <section>
        <div class='d-flex justify-content-between mb-3'>
            <div>
                <h5>{% trans 'Details' %}</h5>
            </div>
            <div>
                {% if perms.research.change_work %}
                <a href='{% url "work:update" object.pk %}'>{% trans 'Edit' %}</a>
                {% endif %}
            </div>
        </div>

        <dl class="row mb-0">
            <dt class="col-sm-3">{% trans 'Name' %}</dt>
            <dd class="col-sm-9">{{ object.name }}</dd>
        
            <dt class="col-sm-3">{% trans 'Subtitle' %}</dt>
            <dd class="col-sm-9">{{ object.subtitle|default:'-' }}</dd>

            <dt class="col-sm-3">{% trans 'Number of Volumes' %}</dt>
            <dd class="col-sm-7">{{ object.number_of_volumes|default:'-' }}</dd>
            {% if perms.research.change_work and perms.research.add_workvolume %}
            <dd class="col-sm-2"><a style='float:right' href='{% url "work:create_volume" object.pk %}'>Add</a></dd>
            {% endif %}

            {% if object.number_of_volumes %}

            <dt class="col-sm-3">{% trans 'Volumes' %}</dt>
            <dd class="col-sm-9">

            {% for volume in object.workvolume_set.all %}
                <div class='d-flex justify-content-between mb-3'>
                    <div>{{ volume.number }}: {{ volume.subtitle }}</div>
                    <div>
                        <form novalidate class='form-inline' action='{% url "work:delete_volume" volume.pk %}' method='POST'>
                            {% csrf_token %}
                            <div class='form-row align-items-center'>
                                {% if perms.research.change_work and perms.research.change_workvolume %}
                                <a href='{% url "work:update_volume" volume.pk %}'>Edit</a>
                                {% endif %}
                                {% if perms.research.change_work and perms.research.delete_workvolume %}
                                <button type='submit' class='btn btn-link text-danger confirm-delete p-0 ml-2'
                                    data-what='volume'>{% trans 'Delete' %}</button>
                                {% endif %}
                            </div>
                        </form>
                    </div>
                </div>
            {% endfor %}
            </dd>

            {% endif %}
        </dl>
    </section>
    
    <hr>
    
    <section>
        <div class='d-flex justify-content-between mb-3'>
            <div>
                <h5>{% trans 'Antiquarians' %}</h5>
            </div>
        </div>

        {% for antiquarian in object.antiquarian_set.all %}

        {% include 'research/partials/antiquarian_list_item.html' %}

        {% endfor %}
    </section>

    <hr>

    <section>
        <div class='d-flex justify-content-between mb-3'>
            <div>
                <h5>{% trans 'Definite Fragments' %}</h5>
            </div>
            <div>
            </div>
        </div>

        {% for fragment in object.definite_fragments.all %}

        {% include 'research/partials/fragment_list_item.html' with fragment=fragment %}

        {% endfor %}
    </section>

    <hr>

    <section>
        <div class='d-flex justify-content-between mb-3'>
            <div>
                <h5>{% trans 'Possible Fragments' %}</h5>
            </div>
            <div>
            </div>
        </div>

        {% for fragment in object.possible_fragments.all %}

        {% include 'research/partials/fragment_list_item.html' with fragment=fragment %}

        {% endfor %}
    </section>

{% endblock %}