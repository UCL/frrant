{% extends "research/list_base.html" %}
{% load i18n get_object_class %}


{% block heading %}
    {% trans 'Search' %}
{% endblock %}

{% block action %}
    {% if search_term %}
    <a href='{% url "search:home" %}'>{% trans 'Clear Search' %}</a>
    {% endif %}
{% endblock %}

{% block inner %}

    <p>
        {% if search_term %}Results for '<span class='alphabetum'>{{ search_term }}</span>'{% endif %}
        {% if to_search %}
          in {{ to_search|join:', ' }}
        {% endif %}

    </p>
    <form novalidate enctype="multipart/form-data" autocomplete='off' action='{{ request.path }}' class="form mb-5" method='GET'>
      <a id="filterToggle" class="btn btn-primary mb-3" data-toggle="collapse" href="#filterFieldset" role="button" aria-expanded="false" aria-controls="filterFieldset">Filter results</a>
      <fieldset class="form-group collapse" id="filterFieldset">
        <div class="form-row">
          <div class="col">
            <label for="antiquarianFilter">Antiquarians</label>
            <select id="antiquarianFilter" class="custom-select" multiple name='ant'>
              {% for antiquarian in antiquarians %}
                <option value="{{ antiquarian.id }}">{{ antiquarian }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="col">
            <label for="citingAuthorFilter">Citing Authors</label>
            <select id="citingAuthorFilter" class="custom-select" multiple name='ca'>
              <option value=1>Matthew</option>
              <option value=2>Mark</option>
              <option value=3>Luke</option>
              <option value=4>John</option>
            </select>
          </div>
        </div>
      </fieldset>
        <div class="form-row align-items-center">
            <div class="col-sm-7 my-1">
                <input type="text" class="form-control alphabetum" name='q' {% if search_term %}value="{{ search_term }}"{% endif %} placeholder="Enter search terms">
            </div>
            <div class="col-sm-3 my-1">
                <select class="form-control" name='what'>
                <option value='all'>Search Everything</option>
                {% for class in search_classes %}
                <option value='{{ class }}'>{{ class|capfirst }}</option>
                {% endfor %}
                </select>
            </div>
            <div class='col-auto'>
                <button type="submit" class="btn btn-block btn-primary">
                        {% trans 'Search' %}
                </button>
            </div>
        </div>

    </form>

    <div class="list-group list-group-flush">
    {% for object in page_obj %}
      <a href='{{ object.get_absolute_url }}' class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
          <h5 class="mb-1">{{ object }}</h5>
          <p><span class='badge badge-secondary badge-pill'>{{ object|get_object_class }}</span></p>
        </div>
        <p class="mb-1">{{object.snippet | safe }}</p>
      </a>
    {% endfor %}
    </ul>

    {{ block.super }}

{% endblock %}
